(function($){$.fn.timeline=function(options){var settings=$.extend({desktopDateIntervals:200,tabletDateIntervals:150,mobileDateIntervals:120,minimalFirstDateInterval:!0,dateDisplay:"dateTime",autoplay:!1,autoplaySpeed:8000,autoplayPause_onHover:!1,useScrollWheel:!1,useTouchSwipe:!0,useKeyboardKeys:!1},options);var $selector='#'+this.attr('id'),timeline=$($selector),eventsContentLi=timeline.find('li');if(eventsContentLi.length>0)initTimeline(timeline);else timeline.css('opacity',1).html('<h3>There are no events at this point in time.<br><br>Please add some content.</h3>');function initTimeline(timeline){var url="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css";addFile('Font-Awesome',url,'css');var timelineComponents={},$timelineWrapper='<div class="timeline"></div>',$timelineEventsWrapper='<div class="events-wrapper"><div class="events"><span class="filling-line" aria-hidden="true"></span></div></div>',$leftNav='<div class="cd-timeline-navigation" id="leftNav"></div>',$prevButton='<a href="" class="fa fa-3x fa-arrow-circle-left prev inactive"></a>',$scrollLeftButton='<a href="" class="fa fa-3x fa-chevron-circle-left scroll-left inactive"></a>',$rightNav='<div class="cd-timeline-navigation" id="rightNav"></div>',$nextButton='<a href="" class="fa fa-3x fa-arrow-circle-right next"></a>',$scrollRightButton='<a href="" class="fa fa-3x fa-chevron-circle-right scroll-right"></a>',$pausePlayWrapper='<div class="cd-timeline-navigation" id="pausePlay"></div>',$pauseButton='<a href="" class="fa fa-3x fa-pause-circle pause"></a>',$playButton='<a href="" class="fa fa-3x fa-play-circle play"></a>';timeline.prepend($timelineWrapper).find('.timeline').append($timelineEventsWrapper).append($leftNav).append($rightNav).find('#leftNav').append($prevButton).append($scrollLeftButton).end().find("#rightNav").append($nextButton).append($scrollRightButton);if(settings.autoplay==!0)
timeline.find('.timeline').append($pausePlayWrapper).find('#pausePlay').append($pauseButton);if(settings.dateDisplay=="dateTime"){timeline.children('.events-content').find('li').each(function(){eventDateDisplay($(this),"dateTime")})}
else if(settings.dateDisplay=="date"){timeline.children('.events-content').find('li').each(function(){eventDateDisplay($(this),"date")})}
else if(settings.dateDisplay=="time"){timeline.children('.events-content').find('li').each(function(){eventDateDisplay($(this),"time")})}
else if(settings.dateDisplay=="dayMonth"){timeline.children('.events-content').find('li').each(function(){eventDateDisplay($(this),"dayMonth")})}
else if(settings.dateDisplay=="monthYear"){timeline.children('.events-content').find('li').each(function(){eventDateDisplay($(this),"monthYear")})}
else if(settings.dateDisplay=="year"){timeline.children('.events-content').find('li').each(function(){eventDateDisplay($(this),"year")})}
function eventDateDisplay(element,display){var dataDate=element.data('date');isDateTime=element.is('[data-date*="T"]'),isTime=element.not('[data-date*="T"]').is('[data-date*=":"]'),dateTimeDisplay=display=="dateTime",dateDisplay=display=="date",timeDisplay=display=="time",dayMonthDisplay=display=="dayMonth",monthYearDisplay=display=="monthYear",yearDisplay=display=="year",$eventDateDisplay=timeline.find('.events'),months=[null,'January','February','March','April','May','June','July','August','September','October','November','December'],monthName=months,dateLink='<a href="" data-date="'+dataDate+'">';function numSuffix(num){if(num>3&&num<21)return'th';switch(num%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}
if(isDateTime){var dateSplit=dataDate.split('T'),date=dateSplit[0],time=dateSplit[1],dateParts=date.split('/'),dayPart=dateParts[0].replace(/^0+/,''),monthPart=dateParts[1].replace(/^0+/,''),yearPart=dateParts[2];if(dateTimeDisplay)$eventDateDisplay.append(dateLink+date+'<br>'+time+'</a>');else if(dateDisplay)$eventDateDisplay.append(dateLink+date+'</a>');else if(timeDisplay)$eventDateDisplay.append(dateLink+time+'</a>');else if(dayMonthDisplay)$eventDateDisplay.append(dateLink+dayPart+numSuffix(dayPart)+'<br>'+monthName[monthPart]+'</a>');else if(monthYearDisplay)$eventDateDisplay.append(dateLink+monthName[monthPart]+'<br>'+yearPart+'</a>');else if(yearDisplay)$eventDateDisplay.append(dateLink+yearPart+'</a>')}
else if(isTime){var time=dataDate;if(dateTimeDisplay||timeDisplay)$eventDateDisplay.append(dateLink+time+'</a>')}
else{var date=dataDate,dateParts=date.split('/'),dayPart=dateParts[0].replace(/^0+/,''),monthPart=dateParts[1].replace(/^0+/,''),yearPart=dateParts[2];if(dateTimeDisplay||dateDisplay)$eventDateDisplay.append(dateLink+date+'</a>');if(dayMonthDisplay)$eventDateDisplay.append(dateLink+dayPart+numSuffix(dayPart)+'<br>'+monthName[monthPart]+'</a>');if(monthYearDisplay)$eventDateDisplay.append(dateLink+monthName[monthPart]+'<br>'+yearPart+'</a>');if(yearDisplay)$eventDateDisplay.append(dateLink+yearPart+'</a>')}}
timelineComponents.timelineWrapper=timeline.find('.events-wrapper');timelineComponents.eventsWrapper=timelineComponents.timelineWrapper.children('.events');timelineComponents.fillingLine=timelineComponents.eventsWrapper.children('.filling-line');timelineComponents.timelineEvents=timelineComponents.eventsWrapper.find('a');timelineComponents.timelineNavigation=timeline.find('.cd-timeline-navigation');timelineComponents.eventsContent=timeline.children('.events-content');timelineComponents.eventsContentLi=timelineComponents.eventsContent.find('li');timelineComponents.eventsContentLi.first().attr('id','first');timelineComponents.eventsContentLi.last().attr('id','last');timelineComponents.timelineEvents.first().addClass("first");timelineComponents.timelineEvents.last().addClass("last");if(timelineComponents.eventsContentLi.hasClass('selected')){var $this=timelineComponents.eventsContent.find('li.selected'),date=$this.data('date'),selectedDate=timelineComponents.eventsWrapper.find('a[data-date="'+date+'"]');selectedDate.addClass('selected');updateOlderEvents(selectedDate)}
else{timelineComponents.eventsContent.find('li#first').addClass('selected');timelineComponents.eventsWrapper.find('a.first').addClass('selected')}
setDatePosition(timelineComponents);var timelineTotalWidth=setTimelineWidth(timelineComponents);timeline.addClass('loaded');$(window).resize(function(e){setDateIntervals();setDatePosition(timelineComponents);timelineTotalWidth=setTimelineWidth(timelineComponents)});timelineComponents.timelineNavigation.on('click','.inactive',function(event){event.stopImmediatePropagation();return(!1)});timelineComponents.timelineNavigation.on('click','a',function(event){event.preventDefault();if($(this).is('.next'))showNewContent(timelineComponents,timelineTotalWidth,'next');if($(this).is('.prev'))showNewContent(timelineComponents,timelineTotalWidth,'prev');if($(this).is('.scroll-right'))updateSlide(timelineComponents,timelineTotalWidth,'right');if($(this).is('.scroll-left'))updateSlide(timelineComponents,timelineTotalWidth,'left')});timelineComponents.eventsWrapper.on('click','a',function(event){var $this=$(this);event.preventDefault();timelineComponents.timelineEvents.removeClass('selected');$this.addClass('selected');updateOlderEvents($this);updateFilling($this,timelineComponents.fillingLine,timelineTotalWidth);updateVisibleContent($this,timelineComponents.eventsContent);updateTimelinePosition($this,timelineComponents)});if(settings.autoplay==!0){var isPaused=!1,current,eventsLength=timelineComponents.timelineEvents.length;setInterval(function(){if(!isPaused){current=timelineComponents.eventsWrapper.find('.selected').index();if(current==eventsLength){showNewContent(timelineComponents,timelineTotalWidth,'start');current=timelineComponents.eventsWrapper.find('.selected').index()}
else{showNewContent(timelineComponents,timelineTotalWidth,'next')}
current ++}},settings.autoplaySpeed);timelineComponents.timelineNavigation.on('click','.pause',function(e){e.preventDefault();isPaused=!0;timeline.find('#pausePlay').html($playButton).addClass('clicked');console.log('Autoplay is paused.')});timelineComponents.timelineNavigation.on('click','.play',function(e){e.preventDefault();isPaused=!1;timeline.find('#pausePlay').html($pauseButton).removeClass('clicked');console.log('Autoplay is playing.')});if(settings.autoplayPause_onHover==!0){var $pausePlay=$('#pausePlay',$selector);if(checkMQ()=='desktop'){timelineComponents.eventsContentLi.hover(function(){if(!$pausePlay.hasClass('clicked')){isPaused=!0;$pausePlay.html($playButton);console.log('Autoplay is paused.')}},function(){if(!$pausePlay.hasClass('clicked')){isPaused=!1;$pausePlay.html($pauseButton);console.log('Autoplay is playing.')}})}}}
var goToTimelineLink=$('.goto-horizontal-timeline');if(goToTimelineLink.length>0){goToTimelineLink.click(function(event){event.preventDefault();var timelineComponents={},$this=$(this),href=$this.attr('href'),$target=$(href),targetSelf=href=="#";if(targetSelf){var gotoself='#'+$this.parents('.cd-horizontal-timeline').attr('id');$target=$(gotoself)}
timelineComponents.timelineWrapper=$target.find('.events-wrapper');timelineComponents.eventsWrapper=timelineComponents.timelineWrapper.children('.events');timelineComponents.fillingLine=timelineComponents.eventsWrapper.children('.filling-line');timelineComponents.timelineEvents=timelineComponents.eventsWrapper.find('a');timelineComponents.timelineNavigation=$target.find('.cd-timeline-navigation');timelineComponents.eventsContent=$target.children('.events-content');timelineComponents.eventsContentLi=timelineComponents.eventsContent.find('li');var datagoto=$this.data('gototimeline'),date,speed,offset,easing,dataDate=datagoto.date,dataScrollSpeed=datagoto.scrollspeed,dataScrollOffset=datagoto.scrolloffset,dataScrollEasing=datagoto.scrolleasing,scrollDefaults={"speed":500,"offset":0,"easing":"linear"};if(typeof datagoto!=='undefined'){date=dataDate;if(typeof dataScrollSpeed!=='undefined')speed=dataScrollSpeed;else speed=scrollDefaults.speed;if(typeof dataScrollOffset!=='undefined')offset=dataScrollOffset;else offset=scrollDefaults.offset;if(typeof dataScrollEasing!=='undefined')easing=dataScrollEasing;else easing=scrollDefaults.easing}
var eventDate='a[data-date="'+date+'"]',prevDates=timelineComponents.eventsWrapper.find('a'),selectedDate=timelineComponents.eventsWrapper.find(eventDate),timelineTotalWidth=timelineComponents.eventsWrapper.width();if(targetSelf)goToTimeline();else{$('html, body').stop().animate({'scrollTop':$target.offset().top-offset},speed,easing,function(){goToTimeline()})}
function goToTimeline(){if(!selectedDate.hasClass('selected')){prevDates.removeClass('selected');selectedDate.addClass('selected');updateOlderEvents(selectedDate);updateFilling(selectedDate,timelineComponents.fillingLine,timelineTotalWidth);updateVisibleContent(selectedDate,timelineComponents.eventsContent)}
updateTimelinePosition(selectedDate,timelineComponents)}})}
if(settings.useScrollWheel==!0){var url="https://cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.1.13/jquery.mousewheel.min.js";addFile('mousewheel',url,'js',function(){window.setTimeout(function(){timelineComponents.eventsContent.on('mousewheel',function(e){if(e.deltaY>0)showNewContent(timelineComponents,timelineTotalWidth,'prev');else showNewContent(timelineComponents,timelineTotalWidth,'next');e.preventDefault()})},300)})}
if(settings.useTouchSwipe==!0){var url="https://cdnjs.cloudflare.com/ajax/libs/jquery.touchswipe/1.6.18/jquery.touchSwipe.min.js";addFile('TouchSwipe',url,'js',function(){window.setTimeout(function(){timelineComponents.eventsContent.swipe({swipeRight:function(event,direction,distance,duration,fingerCount){showNewContent(timelineComponents,timelineTotalWidth,'prev')},swipeLeft:function(event,direction,distance,duration,fingerCount){showNewContent(timelineComponents,timelineTotalWidth,'next')},threshold:75,});timelineComponents.timelineWrapper.swipe({swipeRight:function(event,direction,distance,duration,fingerCount){var translateValue=getTranslateValue(timelineComponents.eventsWrapper),wrapperWidth=Number(timelineComponents.timelineWrapper.width());translateTimeline(timelineComponents,distance+translateValue,wrapperWidth-timelineTotalWidth)},swipeLeft:function(event,direction,distance,duration,fingerCount){var translateValue=getTranslateValue(timelineComponents.eventsWrapper),wrapperWidth=Number(timelineComponents.timelineWrapper.width());translateTimeline(timelineComponents,-distance+translateValue,wrapperWidth-timelineTotalWidth)},threshold:30,})},500)});timelineComponents.timelineWrapper.addClass('touch-enabled').parent().siblings('.events-content').addClass('touch-enabled')}
if(settings.useKeyboardKeys==!0){$(document).keyup(function(event){if(event.which=='37'&&elementInViewport(timeline.get(0)))
showNewContent(timelineComponents,timelineTotalWidth,'prev');else if(event.which=='39'&&elementInViewport(timeline.get(0)))
showNewContent(timelineComponents,timelineTotalWidth,'next')})}
console.log($selector,'initialised')}
function updateSlide(timelineComponents,timelineTotalWidth,string){var translateValue=getTranslateValue(timelineComponents.eventsWrapper),wrapperWidth=Number(timelineComponents.timelineWrapper.width());if(string=='right')translateTimeline(timelineComponents,translateValue-wrapperWidth,wrapperWidth-timelineTotalWidth);else translateTimeline(timelineComponents,translateValue+wrapperWidth)}
function showNewContent(timelineComponents,timelineTotalWidth,string){var visibleContent=timelineComponents.eventsContent.find('.selected'),newContent=(string=='next')?visibleContent.next():visibleContent.prev();if(newContent.length>0){var selectedDate=timelineComponents.eventsWrapper.find('.selected'),newEvent;if(string=='start')newEvent=timelineComponents.eventsWrapper.find('.first');else if(string=='next')newEvent=selectedDate.next('a');else if(string=='prev')newEvent=selectedDate.prev('a');updateFilling(newEvent,timelineComponents.fillingLine,timelineTotalWidth);updateVisibleContent(newEvent,timelineComponents.eventsContent);newEvent.addClass('selected');selectedDate.removeClass('selected');updateOlderEvents(newEvent);updateTimelinePosition(newEvent,timelineComponents)}}
function updateTimelinePosition(event,timelineComponents){var eventLeft=Number(event.css('left').replace('px','')),timelineWidth=timelineComponents.timelineWrapper.width(),timelineTotalWidth=timelineComponents.eventsWrapper.width();translateTimeline(timelineComponents,-eventLeft+timelineWidth/2,timelineWidth-timelineTotalWidth)}
function translateTimeline(timelineComponents,value,totalTranslateValue){var value=(value>0)?0:value;value=(!(typeof totalTranslateValue==='undefined')&&value<totalTranslateValue)?totalTranslateValue:value;setTransformValue(timelineComponents.eventsWrapper,'translateX',value+'px');buttonDisable(timelineComponents,value,totalTranslateValue)}
function updateFilling(selectedEvent,filling,totalTranslateValue){var eventLeft=selectedEvent.css('left').replace('px',''),eventWidth=selectedEvent.css('width').replace('px','');eventLeft=Number(eventLeft)+Number(eventWidth)/2;var scaleValue=eventLeft/totalTranslateValue;setTransformValue(filling,'scaleX',scaleValue)}
function setDatePosition(timelineComponents){var distnew=0,distprev=0,startingNum=0;setDateIntervals();if(settings.minimalFirstDateInterval==!0||checkMQ()=='tinyMobile'||checkMQ()=='mobile'){timelineComponents.timelineEvents.first().css({'left':'0px','padding-left':'10px'});startingNum=1}
for(i=startingNum;i<timelineComponents.timelineEvents.length;i++){distnew=distprev+dateIntervals;timelineComponents.timelineEvents.eq(i).css('left',distnew+'px');distprev=distnew}}
function setTimelineWidth(timelineComponents){var totalWidth=0,wrapperWidth=timelineComponents.timelineWrapper.width(),lastEventLeft=Number(timelineComponents.timelineEvents.last().css('left').replace('px',''))+100;totalWidth=lastEventLeft;if(totalWidth<wrapperWidth)totalWidth=wrapperWidth;timelineComponents.eventsWrapper.css('width',totalWidth+'px');updateFilling(timelineComponents.eventsWrapper.find('a.selected'),timelineComponents.fillingLine,totalWidth);updateTimelinePosition(timelineComponents.eventsWrapper.find('a.selected'),timelineComponents);return totalWidth}
function updateVisibleContent(event,eventsContent){var eventDate=event.data('date'),visibleContent=eventsContent.find('.selected'),selectedContent=eventsContent.find('[data-date="'+eventDate+'"]'),selectedContentHeight=selectedContent.height();if(selectedContent.index()>visibleContent.index()){var classEntering='selected enter-right',classLeaving='leave-left'}
else{var classEntering='selected enter-left',classLeaving='leave-right'}
selectedContent.addClass(classEntering);visibleContent.addClass(classLeaving).one('webkitAnimationEnd oanimationend msAnimationEnd animationend',function(){visibleContent.removeClass('leave-right leave-left');selectedContent.removeClass('enter-left enter-right')}).removeClass('selected')}
function updateOlderEvents(event){event.prevAll('a').addClass('older-event').end().nextAll('a').removeClass('older-event');if(event.is('.selected'))event.removeClass('older-event')}
function getTranslateValue(timeline){var timelineStyle=window.getComputedStyle(timeline.get(0),null),timelineTranslate=timelineStyle.getPropertyValue("-webkit-transform")||timelineStyle.getPropertyValue("-moz-transform")||timelineStyle.getPropertyValue("-ms-transform")||timelineStyle.getPropertyValue("-o-transform")||timelineStyle.getPropertyValue("transform");if(timelineTranslate.indexOf('(')>=0){var timelineTranslate=timelineTranslate.split('(')[1];timelineTranslate=timelineTranslate.split(')')[0];timelineTranslate=timelineTranslate.split(',');var translateValue=timelineTranslate[4]}else{var translateValue=0}
return Number(translateValue)}
function setTransformValue(element,property,value){element.css({"-webkit-transform":property+"("+value+")","-moz-transform":property+"("+value+")","-ms-transform":property+"("+value+")","-o-transform":property+"("+value+")","transform":property+"("+value+")"})}
function elementInViewport(el){var top=el.offsetTop;var left=el.offsetLeft;var width=el.offsetWidth;var height=el.offsetHeight;while(el.offsetParent){el=el.offsetParent;top+=el.offsetTop;left+=el.offsetLeft}
return(top<(window.pageYOffset+window.innerHeight)&&left<(window.pageXOffset+window.innerWidth)&&(top+height)>window.pageYOffset&&(left+width)>window.pageXOffset)}
function setDateIntervals(){if(checkMQ()=='tinyMobile'||checkMQ()=='mobile')dateIntervals=settings.mobileDateIntervals;else if(checkMQ()=='smallTablet'||checkMQ()=='tablet')dateIntervals=settings.tabletDateIntervals;else if(checkMQ()=='desktop')dateIntervals=settings.desktopDateIntervals;var minimumInterval=120;if(dateIntervals<minimumInterval)dateIntervals=minimumInterval}
function checkMQ(){return window.getComputedStyle(document.querySelector($selector),'::before').getPropertyValue('content').replace(/'/g,"").replace(/"/g,"")}
function buttonDisable(timelineComponents,translateValue,totalTranslateValue){var nextButton=timelineComponents.timelineNavigation.find('.next'),prevButton=timelineComponents.timelineNavigation.find('.prev'),leftButton=timelineComponents.timelineNavigation.find('.scroll-left'),rightButton=timelineComponents.timelineNavigation.find('.scroll-right'),firstEvent=timelineComponents.timelineWrapper.find('.first'),lastEvent=timelineComponents.timelineWrapper.find('.last'),wrapperWidth=Number(timelineComponents.timelineWrapper.css('width').replace('px','')),timelineTotalWidth=timelineComponents.eventsWrapper.width();if(wrapperWidth==timelineTotalWidth){leftButton.addClass('inactive');rightButton.addClass('inactive')}
if(firstEvent.is('.selected'))prevButton.addClass('inactive');else prevButton.removeClass('inactive');if(lastEvent.is('.selected'))nextButton.addClass('inactive');else nextButton.removeClass('inactive');if(translateValue==0)leftButton.addClass('inactive');else leftButton.removeClass('inactive');if(translateValue==totalTranslateValue)rightButton.addClass('inactive');else rightButton.removeClass('inactive')}
function addFile(name,url,type,callback){var loadedFile=$('body').data("loadedFile"),fileExists,js=type=='js',css=type=='css',lowerCaseName=name.toLowerCase();if(js)fileExists=$('script').is('[src*="'+lowerCaseName+'"]');else if(css)fileExists=$('link').is('[href*="'+lowerCaseName+'"]');if(loadedFile==undefined)loadedFile=new Array();if(!loadedFile.includes(url)&&!fileExists){if(js){console.log(name+' plugin isn\'t loaded.',$selector);$.getScript(url).done(function(script,textStatus){callback()}).fail(function(jqxhr,settings,exception){console.error("Failed to get "+url+"\n"+jqxhr+"\n"+settings+"\n"+exception)});console.log(name+' was loaded dynamically.',$selector)}
else if(css){console.log(name+' isn\'t loaded.');$('<link>').attr({'href':url,'rel':'stylesheet','type':"text/css"}).insertAfter($('head').find('link').last());console.log(name+' was loaded dynamically.')}
loadedFile.push(url)}
else if(fileExists==!0&&!loadedFile.includes(url)){if(js){console.log(name+' has already been loaded by a <script> tag in the document, no need to load it again. Timeline instance:',$selector);callback()}
loadedFile.push(url)}
else{if(js){console.log(name+' has already been loaded, no need to load it again. Timeline instance:',$selector);callback()}}
if(js){console.log(name+" executed on timeline instance: ",$selector)}
$('body').data("loadedFile",loadedFile)}}}(jQuery))
